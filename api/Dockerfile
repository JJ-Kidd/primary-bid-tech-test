FROM  node:16

WORKDIR /usr/src/app

ARG MONGO_USER
ARG MONGO_PASSWORD
ARG MONGO_URL
ARG MONGO_DB
ARG USE_LOCAL_DB

ENV MONGO_USER=$MONGO_USER
ENV MONGO_PASSWORD=$MONGO_PASSWORD
ENV MONGO_URL=$MONGO_URL
ENV MONGO_DB=$MONGO_DB
ENV USE_LOCAL_DB=$USE_LOCAL_DB

COPY package.json ./

RUN npm install

COPY . .

RUN npm run build

CMD ["node", "dist/main.js"]
